(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{57881:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/finances",function(){return n(2802)}])},2802:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return fe}});var i,a=n(96627),r=n(28598),o=n(36671),s=n(51906),c=n(7847),u=n(46284),l=n(70136),d=n(82015),m=n(97648),g=n(93720),x=n(3134),f=n(80464),h=n(95414),v=n(84407),b=n(65777),Z=n(91362),p=n(22752),j=n(96731),y=n(29878),S=n(50576),C=n(46167),I=n(82684),A=n(81904),w=n(8514),N=n(20336),B=n(86127),D=n(82561),E=n(74451),P=n(67929),F=n(74141),k=n(41826),T=n(73073),V=n(66963),M=n(56865),O=n(37559),L=n(40076),U=n(18567),$=n(35127),_=n(51537),R=n(71468),q=n(84446),z=n(66594),W=n(94866),G=n(32847),K=function(e){var t=e.split("&%&");return{category:t[0],subcategory:t[1]}},H=function(e){var t=(0,I.useContext)(T.Il).setSnackbarData,n=(0,I.useContext)(k.f),i=(0,I.useContext)(T.St).family,o=e.isOpen,s=e.setIsOpen,c=e.initialCatSubcat,u=e.budget,l=e.getBudget,d=(0,I.useState)(""),m=d[0],x=d[1],f=(0,I.useState)(""),h=f[0],v=f[1],b=(0,I.useState)(void 0),Z=b[0],p=b[1],j=(0,I.useState)(""),y=j[0],S=j[1],C=(0,I.useState)(new Date),w=C[0],N=C[1];return(0,r.jsxs)(L.Z,{open:o,onClose:function(){return s(!1)},fullWidth:!0,children:[(0,r.jsx)(U.Z,{children:"Add Transaction"}),(0,r.jsx)($.Z,{children:(0,r.jsxs)(D.Z,{children:[(0,r.jsx)(_.Z,{autoFocus:!0,variant:"standard",label:"Amount",type:"number",value:h,onChange:function(e){return v(e.target.value)}}),(0,r.jsx)(_.Z,{variant:"standard",label:"Description",value:m,onChange:function(e){return x(e.target.value)}}),c?(0,r.jsx)(_.Z,{variant:"standard",label:"Category",value:K(c).subcategory,InputProps:{readOnly:!0},sx:{mt:2,mb:2}}):(0,r.jsx)(R.Z,{options:function(){var e=[];return u.categories.forEach((function(t){t.subcategories.forEach((function(n){e.push({category:t.name,subcategory:n.name})}))})),e}(),groupBy:function(e){return e.category},getOptionLabel:function(e){return e.subcategory},value:Z,onChange:function(e,t){return p(null!==t&&void 0!==t?t:void 0)},inputValue:y,onInputChange:function(e,t){return S(t)},sx:{mt:2,mb:2},renderInput:function(e){return(0,r.jsx)(_.Z,(0,O.Z)((0,A.Z)({},e),{label:"Category",variant:"standard"}))}}),(0,r.jsx)(z._,{dateAdapter:G.Z,children:(0,r.jsx)(W.M,{label:"Date",value:w,onChange:function(e){return N(e)},renderInput:function(e){return(0,r.jsx)(_.Z,(0,O.Z)((0,A.Z)({},e),{variant:"standard"}))}})})]})}),(0,r.jsxs)(q.Z,{children:[(0,r.jsx)(g.Z,{onClick:function(){return s(!1)},children:"Cancel"}),(0,r.jsx)(g.Z,{variant:"contained",onClick:function(){if((null===i||void 0===i?void 0:i.budgetId)&&w){var e={amt:parseFloat(h),name:m,timestamp:w.toString(),category:"",subcategory:""};if(c){var r=K(c);e.category=r.category,e.subcategory=r.subcategory}else Z&&(e.category=Z.category,e.subcategory=Z.subcategory);var o=(0,a.Z)(u.transactions).concat([e]);n.updateBudget(i.budgetId,{transactions:o}).then((function(){t({msg:"Successfully added transaction!",severity:"success"}),l(),s(!1),x(""),v(""),p(void 0),N(new Date)}))}},children:"Save"})]})]})},X=n(82956),J=n(55815),Y=n(38018),Q=n(34179),ee=n(56903),te=function(e){var t=(0,I.useContext)(ae),n=t.setSubCatProperty,i=t.setCatSubcatKey,a=t.setAddingTransaction,o=t.removeSubCategory,s=e.subidx,c=e.category,u=e.subcategory,d=(0,I.useState)(!1),g=d[0],x=d[1],f=(0,I.useState)(void 0),h=f[0],v=f[1],b=function(e,t){return Math.round(e/t*100)>100?"error":"primary"};return(0,r.jsx)(X._l,{draggableId:u.name,index:s,children:function(e){return(0,r.jsx)("div",(0,O.Z)((0,A.Z)({},e.draggableProps,e.dragHandleProps),{ref:e.innerRef,children:(0,r.jsx)(l.Z,{ml:2,mb:1,children:(0,r.jsxs)(E.ZP,{container:!0,alignItems:"center",children:[(0,r.jsxs)(E.ZP,{item:!0,xs:6,onMouseOver:function(){return x(!0)},onMouseOut:function(){return x(!1)},children:[(0,r.jsxs)(D.Z,{direction:"row",alignItems:"center",children:[(0,r.jsx)(V.Z,{fieldName:"Subcategory",fieldType:"ItemName",isValUnique:function(e){return function(e,t){return!e.subcategories.some((function(e){return e.name===t}))}(c,e)},text:u.name,onSubmitValue:function(e){return n(e,u.name,c.name,"name")}}),(0,r.jsx)(F.Z,{onClick:function(e){return v(e.currentTarget)},sx:{display:g?"inherit":"hidden",p:0,ml:1},children:(0,r.jsx)(J.Z,{sx:{fontSize:30}})}),(0,r.jsxs)(Y.Z,{id:"subcat".concat(s,"-menu"),anchorEl:h,open:!!h,onClose:function(){return v(void 0)},children:[(0,r.jsx)(Q.Z,{onClick:function(){i("".concat(c.name).concat("&%&").concat(u.name)),a(!0),v(void 0)},children:"Add transaction"}),(0,r.jsx)(Q.Z,{onClick:function(){o(c.name,u.name),v(void 0)},children:"Delete subcategory"})]})]}),(0,r.jsx)(ee.Z,{value:(t=u.currentSpent,d=u.totalAllotted,100*Math.max(0,Math.min(1,t/d))),color:b(u.currentSpent,u.totalAllotted),variant:"determinate",sx:{width:"85%",mt:1}})]}),(0,r.jsx)(E.ZP,{item:!0,xs:3,children:(0,r.jsx)(V.Z,{fieldName:"Total allotted",fieldType:"DecimalNum",textVariant:"body1",isMonetaryValue:!0,text:u.totalAllotted.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),onSubmitValue:function(e){return n(e,u.name,c.name,"allotted")}})}),(0,r.jsx)(E.ZP,{item:!0,xs:2,ml:1.5,children:(0,r.jsxs)(m.Z,{variant:"body1",children:["$",u.currentSpent.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})})}));var t,d}})},ne=function(e){var t=(0,I.useContext)(ae),n=t.budget,i=t.setCategoryName,a=t.removeCategory,o=t.addNewSubCategory,s=e.idx,c=e.category,u=e.isLastCat,d=(0,I.useState)(!1),g=d[0],x=d[1],h=(0,I.useState)(void 0),v=h[0],b=h[1],Z=function(e){return!n.categories.some((function(t){return t.name===e}))};return(0,r.jsx)(X._l,{draggableId:c.name,index:s,children:function(e){var t,n;return(0,r.jsx)("div",(0,O.Z)((0,A.Z)({},e.draggableProps,e.dragHandleProps),{ref:e.innerRef,children:(0,r.jsxs)(l.Z,{mb:1,children:[(0,r.jsxs)(E.ZP,{container:!0,alignItems:"center",children:[(0,r.jsx)(E.ZP,{item:!0,xs:6,onMouseOver:function(){return x(!0)},onMouseOut:function(){return x(!1)},children:(0,r.jsxs)(D.Z,{direction:"row",alignItems:"center",children:[(0,r.jsx)(V.Z,{fieldName:"Category",fieldType:"ItemName",textVariant:"h5",text:c.name,isValUnique:Z,onSubmitValue:function(e){return i(e,c.name)}}),(0,r.jsx)(F.Z,{onClick:function(e){return b(e.currentTarget)},sx:{display:g?"inherit":"none",p:0,ml:1},children:(0,r.jsx)(J.Z,{sx:{fontSize:30}})}),(0,r.jsxs)(Y.Z,{id:"cat".concat(s,"-menu"),anchorEl:v,open:!!v,onClose:function(){return b(void 0)},children:[(0,r.jsx)(Q.Z,{onClick:function(){return o(c.name)},children:"Add sub-category"}),(0,r.jsx)(Q.Z,{onClick:function(){return a(c.name)},children:"Delete category"})]})]})}),(0,r.jsx)(E.ZP,{item:!0,xs:3,children:(0,r.jsxs)(m.Z,{variant:"body1",ml:1,sx:{fontWeight:"bold"},children:["$",null===(t=c.totalAllotted)||void 0===t?void 0:t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})}),(0,r.jsx)(E.ZP,{item:!0,xs:2,ml:1,children:(0,r.jsxs)(m.Z,{variant:"body1",ml:1,sx:{fontWeight:"bold"},children:["$",null===(n=c.currentSpent)||void 0===n?void 0:n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),(0,r.jsx)(X.bK,{droppableId:"subcats-".concat(c.name),type:"subcategory",children:function(e){return(0,r.jsxs)("div",(0,O.Z)((0,A.Z)({},e.droppableProps),{ref:e.innerRef,children:[c.subcategories.map((function(e,t){return(0,r.jsx)(te,{subidx:t,category:c,subcategory:e},e.name)})),e.placeholder]}))}}),!u&&(0,r.jsx)(f.Z,{})]})}))}})},ie=function(){var e=(0,I.useContext)(ae),t=e.budget,n=e.moveCategory,i=e.moveSubCategory;return(0,r.jsx)(l.Z,{pt:1,pb:1,children:(0,r.jsx)(X.Z5,{onDragEnd:function(e){var t=e.type,a=e.source,r=e.destination;if(a&&r&&t)if("category"===t)n(a.index,r.index);else if("subcategory"===t){var o=a.droppableId.replace("subcats-",""),s=r.droppableId.replace("subcats-","");i(o,s,a.index,r.index)}},children:(0,r.jsx)(X.bK,{droppableId:"budgetCats",type:"category",children:function(e){return(0,r.jsxs)("div",(0,O.Z)((0,A.Z)({},e.droppableProps),{ref:e.innerRef,children:[t.categories.map((function(e,n){return(0,r.jsx)(ne,{idx:n,category:e,budget:t,isLastCat:n===t.categories.length-1},e.name)})),e.placeholder]}))}})})})},ae=I.createContext({}),re=function(e){var t,n,i=(0,I.useContext)(k.f),o=(0,I.useContext)(T.St).family,s=e.budget,c=e.setBudget,u=e.getBudget,g=(0,B.Z)(),x=(0,I.useState)(!1),h=x[0],v=x[1],b=(0,I.useState)(""),Z=b[0],p=b[1];return(0,r.jsxs)(l.Z,{maxWidth:"xl",mx:"auto",children:[(0,r.jsxs)(l.Z,{textAlign:"center",mb:4,mt:2,width:300,mx:"auto",children:[(0,r.jsx)(V.Z,{fieldName:"Budget name",fieldType:"ItemName",isValUnique:function(){return!0},textVariant:"h3",text:s.name,onSubmitValue:function(e){(null===o||void 0===o?void 0:o.budgetId)&&e&&i.updateBudget(o.budgetId,{name:e}).then((function(){return u()}))}}),(0,r.jsx)(m.Z,{variant:"h5",children:(new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"})})]}),(0,r.jsx)(l.Z,{mb:4,width:325,mx:"auto",children:(0,r.jsxs)(d.Z,{sx:{p:2},children:[(0,r.jsxs)(D.Z,{direction:"row",alignContent:"center",spacing:2,mb:2,children:[(0,r.jsx)(m.Z,{variant:"h6",children:"Net Income"}),(0,r.jsx)(V.Z,{fieldName:"Monthly net income",fieldType:"DecimalNum",textVariant:"h5",isMonetaryValue:!0,text:s.monthlyNetIncome.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),onSubmitValue:function(e){(null===o||void 0===o?void 0:o.budgetId)&&e&&i.updateBudget(o.budgetId,{monthlyNetIncome:parseFloat(e)}).then((function(){return u()}))}})]}),(0,r.jsxs)(D.Z,{direction:"row",alignContent:"center",spacing:2,children:[(0,r.jsx)(m.Z,{variant:"h6",children:"Total Allotted"}),(0,r.jsxs)(m.Z,{variant:"h5",children:["$",null===(t=s.totalAllotted)||void 0===t?void 0:t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),function(){if(s.totalAllotted){var e=s.monthlyNetIncome-s.totalAllotted,t="",n="to allot";return e>0?t=g.palette.warning.main:0===e?t=void 0:(n="over-allotted",t=g.palette.error.main),(0,r.jsxs)(m.Z,{variant:"subtitle1",ml:3,color:t,children:["$",Math.abs(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ",n]})}}(),(0,r.jsxs)(D.Z,{direction:"row",alignContent:"center",spacing:2,mt:1,children:[(0,r.jsx)(m.Z,{variant:"h6",children:"Total Spent"}),(0,r.jsxs)(m.Z,{variant:"h5",children:["$",null===(n=s.totalSpent)||void 0===n?void 0:n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),function(){if(s.totalAllotted&&s.totalSpent){var e=s.totalAllotted-s.totalSpent,t="",n="remaining";return e>0?t=g.palette.success.main:0===e?t=void 0:(n="over-budget",t=g.palette.error.main),(0,r.jsxs)(m.Z,{variant:"subtitle1",ml:3,color:t,children:["$",Math.abs(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ",n]})}}()]})}),(0,r.jsx)(l.Z,{children:(0,r.jsxs)(d.Z,{sx:{p:1},children:[(0,r.jsxs)(l.Z,{sx:{position:"sticky",top:60,backgroundColor:g.palette.primary.light,zIndex:1e3},children:[(0,r.jsxs)(E.ZP,{container:!0,alignItems:"center",sx:{p:1},children:[(0,r.jsx)(E.ZP,{item:!0,xs:6,children:(0,r.jsxs)(D.Z,{direction:"row",alignItems:"center",children:[(0,r.jsx)(P.Z,{title:"Add category",children:(0,r.jsx)(F.Z,{onClick:function(){if(null===o||void 0===o?void 0:o.budgetId){for(var e="New Category",t=1;s.categories.some((function(t){return t.name===e}));)e="New Category".concat(t),t++;i.updateBudget(o.budgetId,{categories:(0,a.Z)(s.categories).concat([{name:e,subcategories:[]}])}).then((function(){return u()}))}},children:(0,r.jsx)(w.Z,{})})}),(0,r.jsxs)(D.Z,{children:[(0,r.jsx)(m.Z,{variant:"body1",children:"Category"}),(0,r.jsxs)(D.Z,{direction:"row",alignItems:"end",children:[(0,r.jsx)(N.Z,{}),(0,r.jsx)(m.Z,{variant:"body2",children:"Sub-category"})]})]})]})}),(0,r.jsx)(E.ZP,{item:!0,xs:3,ml:1,children:(0,r.jsx)(m.Z,{variant:"body1",children:"Allotted"})}),(0,r.jsx)(E.ZP,{item:!0,xs:2,children:(0,r.jsx)(m.Z,{variant:"body1",children:"Spent"})})]}),(0,r.jsx)(f.Z,{})]}),(0,r.jsx)(ae.Provider,{value:{budget:s,moveCategory:function(e,t){if(null===o||void 0===o?void 0:o.budgetId){var n=(0,a.Z)(s.categories),r=n[e];n.splice(e,1),n.splice(t,0,r);var l=(0,A.Z)({},s);l.categories=n,c(l),i.updateBudget(o.budgetId,{categories:n}).then((function(){return u()}))}},moveSubCategory:function(e,t,n,r){if(null===o||void 0===o?void 0:o.budgetId){var l=(0,a.Z)(s.categories),d=l.findIndex((function(t){return t.name===e})),m=l.findIndex((function(e){return e.name===t})),g=l[d].subcategories[n];l[d].subcategories.splice(n,1),l[m].subcategories.splice(r,0,g);var x=(0,A.Z)({},s);x.categories=l,c(x),i.updateBudget(o.budgetId,{categories:l}).then((function(){return u()}))}},setCategoryName:function(e,t){if((null===o||void 0===o?void 0:o.budgetId)&&e&&e!==t){var n=(0,a.Z)(s.categories);n[n.findIndex((function(e){return e.name===t}))].name=e;var r=(0,a.Z)(s.transactions);r.forEach((function(n){n.category===t&&(n.category=e)})),i.updateBudget(o.budgetId,{categories:n,transactions:r}).then((function(){return u()}))}},addNewSubCategory:function(e){if(null===o||void 0===o?void 0:o.budgetId){var t=(0,a.Z)(s.categories);t.forEach((function(t){if(t.name===e){for(var n="New SubCategory",i=1;t.subcategories.some((function(e){return e.name===n}));)n="New SubCategory".concat(i),i++;t.subcategories.push({name:n,currentSpent:0,totalAllotted:0})}})),i.updateBudget(o.budgetId,{categories:t}).then((function(){return u()}))}},removeCategory:function(e){if((null===o||void 0===o?void 0:o.budgetId)&&window.confirm("Are you sure you want to delete category ".concat(e,"?"))){var t=(0,a.Z)(s.categories),n=(0,a.Z)(s.transactions);t.splice(t.findIndex((function(t){return t.name===e})),1),n.forEach((function(t){t.category===e&&(t.category="N/A")})),i.updateBudget(o.budgetId,{categories:t,transactions:n}).then((function(){return u()}))}},setSubCatProperty:function(e,t,n,r){if((null===o||void 0===o?void 0:o.budgetId)&&e&&e!==t){var c=(0,a.Z)(s.categories),l=(0,a.Z)(s.transactions);c.forEach((function(i){i.name===n&&i.subcategories.forEach((function(i){i.name===t&&("name"===r?(l.forEach((function(i){i.category===n&&i.subcategory===t&&(i.subcategory=e)})),i.name=e):"allotted"===r?i.totalAllotted=parseFloat(e):console.error("Invalid property to set for subcat"))}))})),i.updateBudget(o.budgetId,{categories:c,transactions:l}).then((function(){return u()}))}},removeSubCategory:function(e,t){if((null===o||void 0===o?void 0:o.budgetId)&&window.confirm("Are you sure you want to delete subcategory ".concat(t," in category ").concat(e,"?"))){var n=(0,a.Z)(s.categories),r=(0,a.Z)(s.transactions);n.forEach((function(n){n.name===e&&n.subcategories.splice(n.subcategories.findIndex((function(e){return e.name===t})),1)})),r.forEach((function(n){n.category===e&&n.subcategory===t&&(n.subcategory="N/A")})),i.updateBudget(o.budgetId,{categories:n,transactions:r}).then((function(){return u()}))}},setAddingTransaction:v,setCatSubcatKey:p},children:(0,r.jsx)(ie,{})})]})}),(0,r.jsx)(d.Z,{sx:{mt:4,height:"25vw","@media (max-width:600px)":{height:"100vw"}},children:(0,r.jsx)(M.ZP,{chartType:"PieChart",width:"100%",height:"100%",data:function(e){var t=[["Category","Percent"]];return e.forEach((function(e){e.totalAllotted&&s.totalAllotted&&t.push([e.name,e.totalAllotted/s.totalAllotted*100])})),t}(s.categories),options:{title:"Percent of Allotted Budget",is3D:!1}})}),(0,r.jsx)(H,{isOpen:h,setIsOpen:v,budget:s,getBudget:u,initialCatSubcat:Z})]},s.id)},oe=n(51012),se=function(e){var t=[["Name","Amount"]];return e.forEach((function(e){t.push([e.name,e.currentAmt])})),t},ce=function(e){var t=(0,I.useContext)(k.f),n=(0,I.useContext)(T.St).family,i=e.budget,o=e.getBudget,s=function(e){return!i.savingsBlobs.some((function(t){return t.name===e}))},c=function(e){(null===n||void 0===n?void 0:n.budgetId)&&t.updateBudget(n.budgetId,{savingsBlobs:e}).then((function(){return o()}))};return(0,r.jsxs)(l.Z,{mt:2,ml:1,mr:1,children:[(0,r.jsx)(m.Z,{variant:"h3",mb:2,children:"Savings Blobs"}),(0,r.jsxs)(d.Z,{sx:{p:1,maxWidth:"auto",mb:2},children:[(0,r.jsx)(m.Z,{variant:"h4",children:"Total Saved:"}),(0,r.jsxs)(m.Z,{variant:"h5",children:["$",i.savingsBlobs.reduce((function(e,t){return e+t.currentAmt}),0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,r.jsx)(g.Z,{variant:"contained",startIcon:(0,r.jsx)(w.Z,{}),onClick:function(){for(var e=(0,a.Z)(i.savingsBlobs),t="New Blob",n=1;e.some((function(e){return e.name===t}));)t="New Blob".concat(n),n++;e.push({name:t,currentAmt:0}),c(e)},children:"Create New Blob"}),(0,r.jsx)(D.Z,{mb:4,spacing:1,mt:2,children:i.savingsBlobs.map((function(e){return(0,r.jsxs)(d.Z,{sx:{p:1},children:[(0,r.jsxs)(D.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,r.jsx)(V.Z,{fieldName:"Blob name",fieldType:"ItemName",text:e.name,textVariant:"h6",isValUnique:s,onSubmitValue:function(t){return function(e,t){if(t){var n=(0,a.Z)(i.savingsBlobs);n[n.findIndex((function(t){return t.name===e}))].name=t,c(n)}}(e.name,t)}}),(0,r.jsx)(F.Z,{sx:{ml:4},onClick:function(){return function(e){var t=(0,a.Z)(i.savingsBlobs);t.splice(t.findIndex((function(t){return t.name===e})),1),c(t)}(e.name)},children:(0,r.jsx)(oe.Z,{})})]}),(0,r.jsx)(V.Z,{fieldName:"Amount",fieldType:"DecimalNum",textVariant:"body1",text:e.currentAmt.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),isMonetaryValue:!0,onSubmitValue:function(t){return function(e,t){if(t){var n=(0,a.Z)(i.savingsBlobs);n[n.findIndex((function(t){return t.name===e}))].currentAmt=parseFloat(t),c(n)}}(e.name,t)}})]},e.name)}))}),(0,r.jsx)(d.Z,{sx:{mb:4,height:"25vw","@media (max-width:600px)":{height:"100vw"}},children:(0,r.jsx)(M.ZP,{chartType:"PieChart",width:"100%",height:"100%",data:se(i.savingsBlobs),options:{title:"Savings Breakdown",pieHole:.5,is3D:!1}})})]})},ue=n(65961),le=n(43813),de=[{field:"amt",headerName:"Amount",minWidth:65,type:"number",flex:1,editable:!0,valueFormatter:function(e){return null===e.value?"":"$".concat(e.value.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))}},{field:"name",headerName:"Description",minWidth:120,flex:1,editable:!0},{field:"subcategory",headerName:"Subcategory",minWidth:90,flex:1},{field:"timestamp",headerName:"Date",type:"date",flex:1,width:100,editable:!0,valueGetter:function(e){return new Date(e.value)}}],me=function(e){var t=e.budget,n=e.getBudget,i=(0,I.useContext)(k.f),o=(0,I.useContext)(T.St).family,s=(0,I.useState)(!1),c=s[0],u=s[1],d=(0,I.useState)([]),x=d[0],f=d[1],h=(0,I.useState)(20),v=h[0],b=h[1];return(0,r.jsxs)(l.Z,{mt:2,ml:1,mr:1,children:[(0,r.jsx)(m.Z,{variant:"h3",mb:2,children:"Transactions"}),(0,r.jsx)(g.Z,{startIcon:(0,r.jsx)(w.Z,{}),variant:"contained",onClick:function(){return u(!0)},children:"Add transaction"}),(0,r.jsx)(D.Z,{height:500,mt:3,mb:2,children:(0,r.jsx)(le._,{columns:de,rows:t.transactions,pageSize:v,onPageSizeChange:function(e){return b(e)},rowsPerPageOptions:[10,20,50,100],selectionModel:x,onSelectionModelChange:f,experimentalFeatures:{newEditingApi:!0},initialState:{sorting:{sortModel:[{field:"timestamp",sort:"desc"}]}},processRowUpdate:function(e,r){if(!(null===o||void 0===o?void 0:o.budgetId))return r;e.timestamp=e.timestamp.toString();var s=(0,a.Z)(t.transactions);return s[s.findIndex((function(e){return e.id===r.id}))]=e,i.updateBudget(o.budgetId,{transactions:s}).then(n),e},checkboxSelection:!0,disableSelectionOnClick:!0})}),x.length>0&&(0,r.jsxs)(g.Z,{startIcon:(0,r.jsx)(ue.Z,{}),variant:"contained",color:"error",onClick:function(){if(null===o||void 0===o?void 0:o.budgetId){var e=(0,a.Z)(t.transactions);e=e.filter((function(e,t){return-1===x.indexOf(t)})),i.updateBudget(o.budgetId,{transactions:e}).then((function(){n(),f([])}))}},sx:{mb:3},children:["Remove transaction",x.length>1&&"s"]}),(0,r.jsx)(H,{isOpen:c,setIsOpen:u,budget:t,getBudget:n})]})},ge=n(55402);n(84333);!function(e){e[e.BUDGET=0]="BUDGET",e[e.SAVINGS=1]="SAVINGS",e[e.TRANSACTIONS=2]="TRANSACTIONS"}(i||(i={}));var xe=function(e){var t=e.createAndSaveDefaultBudget;return(0,r.jsx)(l.Z,{maxWidth:"sm",textAlign:"center",mt:4,mx:"auto",children:(0,r.jsxs)(d.Z,{sx:{p:2},children:[(0,r.jsx)(m.Z,{variant:"h6",children:"You don't have a budget yet!"}),(0,r.jsx)(m.Z,{variant:"subtitle1",mb:4,children:"Create one?"}),(0,r.jsx)(g.Z,{variant:"contained",onClick:t,children:"Create Budget"})]})})},fe=function(){var e=(0,I.useContext)(k.f),t=(0,I.useContext)(T.St),n=t.userId,g=t.profile,A=t.family,w=t.getFamily,N=(0,I.useState)(0),B=N[0],D=N[1],E=(0,I.useState)(void 0),P=E[0],F=E[1],V=(0,I.useState)(!1),M=V[0],O=V[1],L=function(){(null===A||void 0===A?void 0:A.budgetId)&&(O(!0),e.getBudget(A.budgetId).then((function(e){if(O(!1),e.exists()){var t=e.data();t.categories?t.categories.forEach((function(e){e.currentSpent=0,e.subcategories.forEach((function(e){return e.currentSpent=0}))})):(console.error("Missing budget categories array!"),t.categories=[]),t.transactions?t.transactions.forEach((function(e,n){e.id=n;var i=t.categories.findIndex((function(t){return t.name===e.category})),a=t.categories[i].subcategories.findIndex((function(t){return t.name===e.subcategory}));new Date(e.timestamp).getMonth()===(new Date).getMonth()&&-1!==i&&-1!==a&&(t.categories[i].subcategories[a].currentSpent+=e.amt)})):(console.error("Missing budget categories array!"),t.transactions=[]);var n=0,i=0;t.categories.forEach((function(e){e.totalAllotted=e.subcategories.reduce((function(e,t){return e+t.totalAllotted}),0),i+=e.totalAllotted,e.currentSpent=e.subcategories.reduce((function(e,t){return e+t.currentSpent}),0),n+=e.currentSpent})),t.totalSpent=n,t.totalAllotted=i,F(t)}})))};(0,I.useEffect)((function(){A&&A.budgetId?L():F(void 0)}),[A]);var U=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{}),(0,r.jsx)(m.Z,{variant:"h6",mt:2,mb:1,mx:"auto",children:"Finance Dashboard"}),(0,r.jsx)(f.Z,{}),(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(v.ZP,{children:(0,r.jsxs)(b.Z,{onClick:function(){return D(i.BUDGET)},selected:0===B,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(o.Z,{})}),(0,r.jsx)(p.Z,{children:"Budget"})]})}),(0,r.jsx)(v.ZP,{children:(0,r.jsxs)(b.Z,{onClick:function(){return D(i.SAVINGS)},selected:1===B,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(s.Z,{})}),(0,r.jsx)(p.Z,{children:"Savings"})]})}),(0,r.jsx)(v.ZP,{children:(0,r.jsxs)(b.Z,{onClick:function(){return D(i.TRANSACTIONS)},selected:3===B,children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(c.Z,{})}),(0,r.jsx)(p.Z,{children:"Transactions"})]})})]}),(0,r.jsx)(f.Z,{}),(0,r.jsx)(h.Z,{children:(0,r.jsx)(v.ZP,{children:(0,r.jsxs)(b.Z,{onClick:function(){if(P){var e="FinanceData-".concat((new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"}).replace(" ","-"),"\n    "),t={budget:{name:P.name,netIncome:P.monthlyNetIncome,totalAllotted:P.totalAllotted,totalSpent:P.totalSpent,categories:(0,a.Z)(P.categories)},savingsBlobs:(0,a.Z)(P.savingsBlobs),transactions:(0,a.Z)(P.transactions)},n=JSON.stringify(t,null,2),i=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=e+".json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}},children:[(0,r.jsx)(Z.Z,{children:(0,r.jsx)(u.Z,{})}),(0,r.jsx)(p.Z,{children:"Export budget data"})]})})})]});return(0,r.jsx)(r.Fragment,{children:P?(0,r.jsxs)(l.Z,{display:"flex",children:[(0,r.jsx)(d.Z,{sx:{position:"fixed",bottom:0,left:0,right:0,zIndex:100,pb:2},elevation:5,children:(0,r.jsxs)(y.Z,{showLabels:!0,value:B,onChange:function(e,t){return D(t)},sx:{display:{xs:"normal",sm:"none"}},children:[(0,r.jsx)(S.Z,{label:"Budget",icon:(0,r.jsx)(o.Z,{})}),(0,r.jsx)(S.Z,{label:"Savings",icon:(0,r.jsx)(s.Z,{})}),(0,r.jsx)(S.Z,{label:"Transactions",icon:(0,r.jsx)(c.Z,{})})]})}),(0,r.jsx)(C.ZP,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},flexShrink:0,width:250},children:U}),(0,r.jsx)(l.Z,{flexGrow:1,p:1,pb:6,children:function(){if(P){var e=(0,r.jsx)(re,{budget:P,setBudget:F,getBudget:L});switch(B){case 0:default:return e;case 1:return(0,r.jsx)(ce,{budget:P,getBudget:L});case 2:return(0,r.jsx)(me,{budget:P,getBudget:L})}}}()})]}):M?(0,r.jsx)(l.Z,{mx:"auto",textAlign:"center",mt:20,children:(0,r.jsx)(j.Z,{size:60})}):(0,r.jsx)(xe,{createAndSaveDefaultBudget:function(){if(n&&g){var t=(0,ge.Z)(),i={name:"My Budget",id:t,editors:[n],monthlyNetIncome:3e3,categories:[{name:"Essentials",subcategories:[{name:"Rent",totalAllotted:1250,currentSpent:0},{name:"Utilities",totalAllotted:300,currentSpent:0}]},{name:"Lifestyle",subcategories:[{name:"Spending",totalAllotted:300,currentSpent:0}]}],savingsBlobs:[{name:"Default Blob",currentAmt:1e3}],transactions:[{id:0,name:"Default transaction",amt:10,category:"Essentials",subcategory:"Rent",timestamp:Date.now().toString()}]};e.updateFamily(g.familyId,{budgetId:t}).then((function(){e.createBudget(t,i).then((function(){w()}))}))}}})})}},66963:function(e,t,n){"use strict";var i=n(28598),a=n(82684),r=n(97648),o=n(14048);t.Z=function(e){var t=e.isValUnique,n=e.onSubmitValue,s=e.fieldType,c=e.fieldName,u=e.text,l=e.textVariant,d=e.isMonetaryValue,m=(0,a.useState)(!1),g=m[0],x=m[1],f=(0,a.useState)(!1),h=f[0],v=f[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.Z,{variant:null!==l&&void 0!==l?l:"h6",onClick:function(){x(!0),v(!1)},onMouseOver:function(){return v(!0)},onMouseOut:function(){return v(!1)},sx:{borderBottom:h?"2px solid green":""},children:[d&&"$",u]}),(0,i.jsx)(o.Z,{initialValue:d?u.replaceAll(",",""):u,fieldName:c,fieldType:s,isOpen:g,onClosed:function(){return x(!1)},isMonetaryValue:d,isValUnique:t,onSubmitValue:n})]})}},14048:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var i=n(28598),a=n(82684),r=n(40076),o=n(18567),s=n(35127),c=n(82561),u=n(51537),l=n(22546),d=n(67929),m=n(74141),g=n(84446),x=n(93720),f={Email:{name:"email",regex:/^[^@\s]+@[^@\s]+\.[^@\s]+$/,valErrMsg:"Please provide a valid email"},Password:{name:"password",regex:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/,valErrMsg:"Password must be a minimum of eight characters, and contain at least one letter and number"},EntityName:{name:"entityName",regex:/^[\s\S]{1,50}$/,valErrMsg:"Entity names have a max length of 50 characters"},ItemName:{name:"itemName",regex:/^[\s\S]{1,100}$/,valErrMsg:"Item names have a max length of 100 characters"},ApiToken:{name:"apiToken",regex:/^[A-Za-z0-9_-]*$/,valErrMsg:"API tokens can only contain letters, numbers, hyphens, and underscores"},DecimalNum:{name:"decimalNum",regex:/^[+-]?([0-9]+\.?[0-9]*|\.[0-9]+)$/,valErrMsg:"Numerical values can only contain numbers, decimals, and signs"}},h="Field cannot be empty",v="Item names must be unique",b=n(18786),Z=n(5295),p=n(22912),j=function(e){var t=e.initialValue,n=e.isMonetaryValue,j=e.fieldName,y=e.fieldType,S=e.onSubmitValue,C=e.isOpen,I=e.onClosed,A=e.isValUnique,w=e.titleVerb,N=void 0===w?"Edit":w,B=(0,a.useState)(void 0),D=B[0],E=B[1],P=(0,a.useState)(null!==t&&void 0!==t?t:""),F=P[0],k=P[1];if("ItemName"===y&&!A)return console.error("Field is of type ItemName, but no function was provided to validate uniqueness."),null;var T=function(e){k(null!==e&&void 0!==e?e:""),e?!A||A(e)?e.match(f[y].regex)?E(void 0):E(f[y].valErrMsg):E(v):E(h)};return(0,a.useEffect)((function(){k(null!==t&&void 0!==t?t:"")}),[t]),(0,i.jsxs)(r.Z,{open:C,onClose:I,fullWidth:!0,style:{marginBottom:"35vh"},children:[(0,i.jsx)(o.Z,{children:"".concat(N," ").concat(j)}),(0,i.jsx)(s.Z,{children:(0,i.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(u.Z,{variant:"standard",label:j,value:F,onChange:function(e){return T(e.target.value)},error:!!D,helperText:D,InputProps:{startAdornment:n?(0,i.jsx)(l.Z,{position:"start",children:"$"}):void 0},required:!0,autoFocus:!0}),n&&(0,i.jsx)(d.Z,{title:"Calculate value",children:(0,i.jsx)(m.Z,{onClick:function(){F&&T("".concat((0,Z.NMM)((0,p.ku)(F),2)))},sx:{height:"50%"},children:(0,i.jsx)(b.Z,{})})})]})}),(0,i.jsxs)(g.Z,{children:[(0,i.jsx)(x.Z,{onClick:I,children:"Cancel"}),(0,i.jsx)(x.Z,{variant:"contained",disabled:!!D,onClick:function(){F!==t&&S(F),I()},children:"Save"})]})]})}},75042:function(){}},function(e){e.O(0,[630,847,876,28,919,287,435,895,774,888,179],(function(){return t=57881,e(e.s=t);var t}));var t=e.O();_N_E=t}]);